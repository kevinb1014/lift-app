<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lift</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

```
    :root {
        --bg-primary: #0a0a0a;
        --bg-secondary: #141414;
        --bg-tertiary: #1a1a1a;
        --bg-elevated: #1f1f1f;
        --border-color: #2a2a2a;
        --border-hover: #3a3a3a;
        --text-primary: #ffffff;
        --text-secondary: #a0a0a0;
        --text-tertiary: #707070;
        --accent-primary: #fc5200;
        --accent-secondary: #ff7a3d;
        --accent-hover: #ff6620;
        --success: #00d084;
        --warning: #ffa500;
        --surface-hover: #1f1f1f;
        --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.4);
        --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.5);
        --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.6);
        --radius-sm: 6px;
        --radius-md: 8px;
        --radius-lg: 12px;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html,
    body {
        overflow-x: hidden;
        width: 100%;
    }

    body {
        font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: var(--bg-primary);
        color: var(--text-primary);
        line-height: 1.6;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    .app-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 16px;
        animation: fadeIn 0.4s ease-out;
        width: 100%;
        max-width: 100vw;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(8px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Header */
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 28px 0 36px;
        border-bottom: 1px solid var(--border-color);
        margin-bottom: 36px;
    }

    .logo {
        font-size: 22px;
        font-weight: 700;
        letter-spacing: -0.8px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .logo-icon {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        box-shadow: 0 0 20px rgba(252, 82, 0, 0.3);
    }

    .header-nav {
        display: flex;
        gap: 8px;
        background: var(--bg-secondary);
        padding: 4px;
        border-radius: var(--radius-md);
        border: 1px solid var(--border-color);
    }

    .nav-btn {
        padding: 8px 20px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border-radius: var(--radius-sm);
        transition: all 0.2s ease;
        font-family: 'DM Sans', sans-serif;
    }

    .nav-btn:hover {
        color: var(--text-primary);
        background: var(--bg-tertiary);
    }

    .nav-btn.active {
        background: var(--bg-primary);
        color: var(--text-primary);
        box-shadow: var(--shadow-sm);
    }

    .header-actions {
        display: flex;
        gap: 12px;
    }

    /* Buttons */
    .btn {
        padding: 9px 18px;
        border: none;
        background: var(--bg-secondary);
        color: var(--text-primary);
        border-radius: var(--radius-md);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-family: 'DM Sans', sans-serif;
        white-space: nowrap;
    }

    .btn:hover {
        background: var(--bg-tertiary);
        transform: translateY(-1px);
    }

    .btn:active {
        transform: translateY(0);
    }

    .btn-primary {
        background: var(--accent-primary);
        color: white;
        box-shadow: 0 0 20px rgba(252, 82, 0, 0.2);
    }

    .btn-primary:hover {
        background: var(--accent-hover);
        box-shadow: 0 0 25px rgba(252, 82, 0, 0.3);
    }

    .btn-secondary {
        border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
        border-color: var(--border-hover);
    }

    .btn-ghost {
        background: transparent;
    }

    .btn-ghost:hover {
        background: var(--bg-tertiary);
    }

    .btn svg {
        flex-shrink: 0;
    }

    /* View Containers */
    .view-container {
        display: none;
        animation: slideIn 0.3s ease-out;
    }

    .view-container.active {
        display: block;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(12px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Weekly View */
    .week-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 28px;
    }

    .week-navigation,
    .month-navigation {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .week-title,
    .month-title {
        font-size: 18px;
        font-weight: 700;
        letter-spacing: -0.5px;
        color: var(--text-primary);
        min-width: 140px;
        text-align: center;
        white-space: nowrap;
    }

    .week-nav-btn,
    .month-nav-btn {
        width: 36px;
        height: 36px;
        border: 1px solid var(--border-color);
        background: var(--bg-secondary);
        color: var(--text-secondary);
        border-radius: var(--radius-md);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .week-nav-btn:hover,
    .month-nav-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border-color: var(--border-hover);
    }

    .week-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 16px;
    }

    .day-card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: 16px;
        min-height: 200px;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .day-card:hover {
        border-color: var(--border-hover);
        background: var(--bg-tertiary);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }

    .day-card.today {
        border-color: var(--accent-primary);
        box-shadow: 0 0 0 1px var(--accent-primary);
    }

    .day-card.has-workout {
        background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(252, 82, 0, 0.05) 100%);
    }

    .day-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px solid var(--border-color);
    }

    .day-name {
        font-size: 13px;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .day-date {
        font-size: 20px;
        font-weight: 700;
        color: var(--text-primary);
    }

    .day-card.today .day-date {
        color: var(--accent-primary);
    }

    .exercises-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .exercise-item {
        padding: 10px 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        font-size: 13px;
        color: var(--text-primary);
        cursor: move;
        transition: all 0.2s ease;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
    }

    .exercise-item:hover {
        border-color: var(--accent-primary);
        background: var(--bg-tertiary);
    }

    .exercise-item.dragging {
        opacity: 0.5;
        transform: rotate(2deg);
    }

    .exercise-item-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex: 1;
        min-width: 0;
    }

    .exercise-name {
        font-weight: 500;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .exercise-stats {
        font-size: 11px;
        color: var(--text-tertiary);
        font-family: 'JetBrains Mono', monospace;
        white-space: nowrap;
    }

    .exercise-item-edit {
        background: transparent;
        border: none;
        color: var(--text-tertiary);
        cursor: pointer;
        padding: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: var(--radius-sm);
        transition: all 0.2s ease;
        flex-shrink: 0;
    }

    .exercise-item-edit:hover {
        background: var(--bg-secondary);
        color: var(--accent-primary);
    }

    .add-exercise-btn {
        width: 100%;
        padding: 10px;
        margin-top: 8px;
        background: var(--bg-primary);
        border: 1px dashed var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-secondary);
        font-size: 13px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        font-family: 'DM Sans', sans-serif;
    }

    .add-exercise-btn:hover {
        border-color: var(--accent-primary);
        color: var(--accent-primary);
        background: rgba(252, 82, 0, 0.05);
    }

    /* Monthly View */
    .month-header {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 28px;
    }

    .calendar-grid {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: 20px;
    }

    .calendar-day-names {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 8px;
        margin-bottom: 12px;
    }

    .calendar-day-name {
        text-align: center;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-tertiary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        padding: 8px;
    }

    .calendar-days {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 8px;
    }

    .calendar-day {
        aspect-ratio: 1;
        padding: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        flex-direction: column;
        position: relative;
        overflow: hidden;
    }

    .calendar-day:hover {
        border-color: var(--border-hover);
        background: var(--bg-tertiary);
        transform: scale(1.02);
    }

    .calendar-day.other-month {
        opacity: 0.3;
        pointer-events: none;
    }

    .calendar-day.today {
        border-color: var(--accent-primary);
        box-shadow: 0 0 0 1px var(--accent-primary);
    }

    .calendar-day.has-workout {
        background: linear-gradient(135deg, var(--bg-primary) 0%, rgba(252, 82, 0, 0.08) 100%);
    }

    .calendar-day.has-workout::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 8px;
        height: 8px;
        background: var(--accent-primary);
        border-radius: 0 var(--radius-md) 0 var(--radius-md);
    }

    .calendar-day-number {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 4px;
    }

    .calendar-day.today .calendar-day-number {
        color: var(--accent-primary);
    }

    .calendar-day-exercises {
        font-size: 10px;
        color: var(--text-tertiary);
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    /* Modals */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 1000;
        animation: modalFadeIn 0.2s ease-out;
    }

    .modal.active {
        display: flex;
        align-items: center;
        justify-content: center;
    }

    @keyframes modalFadeIn {
        from {
            opacity: 0;
        }
        to {
            opacity: 1;
        }
    }

    .modal-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(4px);
    }

    .modal-content {
        position: relative;
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        box-shadow: var(--shadow-lg);
        animation: modalSlideUp 0.3s ease-out;
    }

    @keyframes modalSlideUp {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .modal-lg {
        max-width: 700px;
    }

    .modal-header {
        padding: 24px 24px 20px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
    }

    .modal-header h3 {
        font-size: 20px;
        font-weight: 700;
        letter-spacing: -0.5px;
        color: var(--text-primary);
    }

    .text-secondary {
        color: var(--text-secondary);
        font-size: 14px;
        margin-top: 4px;
    }

    .modal-close {
        width: 32px;
        height: 32px;
        background: transparent;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .modal-close:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
    }

    .modal-body {
        padding: 24px;
        overflow-y: auto;
        overflow-x: hidden;
        flex: 1;
    }

    .modal-footer {
        padding: 20px 24px;
        border-top: 1px solid var(--border-color);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
    }

    /* Forms */
    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-size: 13px;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .input {
        width: 100%;
        padding: 12px 14px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        color: var(--text-primary);
        font-size: 16px;
        font-family: 'DM Sans', sans-serif;
        transition: all 0.2s ease;
    }

    .input:focus {
        outline: none;
        border-color: var(--accent-primary);
        box-shadow: 0 0 0 3px rgba(252, 82, 0, 0.1);
    }

    .input::placeholder {
        color: var(--text-tertiary);
    }

    /* Exercise Log Entries */
    .exercise-log-entry {
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        padding: 16px;
        margin-bottom: 16px;
        transition: all 0.2s ease;
        overflow-x: hidden;
    }

    .exercise-log-entry:hover {
        border-color: var(--border-hover);
    }

    .exercise-log-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        cursor: pointer;
    }

    .exercise-log-name {
        font-size: 15px;
        font-weight: 600;
        color: var(--text-primary);
    }

    .exercise-log-toggle {
        color: var(--text-secondary);
        font-size: 12px;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s ease;
    }

    .exercise-log-toggle svg {
        transition: transform 0.2s ease;
    }

    .exercise-log-entry.expanded .exercise-log-toggle svg {
        transform: rotate(180deg);
    }

    .last-week-data {
        background: rgba(252, 82, 0, 0.05);
        border-left: 2px solid var(--accent-primary);
        padding: 10px 12px;
        margin-bottom: 12px;
        border-radius: var(--radius-sm);
        font-size: 12px;
        color: var(--text-secondary);
        display: none;
    }

    .exercise-log-entry.expanded .last-week-data {
        display: block;
    }

    .last-week-label {
        color: var(--accent-primary);
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-size: 11px;
        margin-bottom: 6px;
    }

    .set-inputs {
        display: none;
        flex-direction: column;
        gap: 10px;
        overflow-x: hidden;
        width: 100%;
    }

    .exercise-log-entry.expanded .set-inputs {
        display: flex;
    }

    .set-row {
        display: grid;
        grid-template-columns: 60px 1fr 1fr;
        gap: 10px;
        align-items: center;
    }

    .set-label {
        font-size: 13px;
        font-weight: 600;
        color: var(--text-tertiary);
    }

    .set-input-group {
        display: flex;
        flex-direction: column;
        gap: 4px;
        min-width: 0;
    }

    .set-input-label {
        font-size: 11px;
        color: var(--text-tertiary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 600;
        text-align: center;
    }

    .set-input {
        padding: 10px 8px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-primary);
        font-size: 16px;
        font-family: 'JetBrains Mono', monospace;
        text-align: center;
        transition: all 0.2s ease;
        width: 100%;
        min-width: 0;
        box-sizing: border-box;
    }

    .set-input:focus {
        outline: none;
        border-color: var(--accent-primary);
        background: var(--bg-primary);
    }

    /* Exercise Select List */
    .exercise-select-list {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .exercise-select-item {
        display: flex;
        align-items: center;
        padding: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .exercise-select-item:hover {
        border-color: var(--border-hover);
        background: var(--bg-tertiary);
    }

    .exercise-select-item input[type="checkbox"] {
        margin-right: 12px;
        width: 18px;
        height: 18px;
        cursor: pointer;
        accent-color: var(--accent-primary);
    }

    .exercise-select-item label {
        flex: 1;
        cursor: pointer;
        font-size: 14px;
        color: var(--text-primary);
    }

    /* Manage Exercises List */
    .manage-exercise-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-md);
        margin-bottom: 8px;
        transition: all 0.2s ease;
    }

    .manage-exercise-item:hover {
        border-color: var(--border-hover);
    }

    .exercise-info {
        flex: 1;
        min-width: 0;
    }

    .manage-exercise-item input {
        flex: 1;
        background: transparent;
        border: none;
        color: var(--text-primary);
        font-size: 14px;
        font-family: 'DM Sans', sans-serif;
        padding: 4px;
        width: 100%;
    }

    .manage-exercise-item input:focus {
        outline: none;
        background: var(--bg-tertiary);
        border-radius: var(--radius-sm);
    }

    .manage-exercise-item input:disabled {
        cursor: default;
    }

    .exercise-days {
        display: flex;
        gap: 6px;
        margin-top: 8px;
        flex-wrap: wrap;
    }

    .day-pill {
        min-width: 32px;
        height: 28px;
        padding: 0 8px;
        background: var(--bg-tertiary);
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-tertiary);
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: 'DM Sans', sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .day-pill:hover {
        border-color: var(--border-hover);
        background: var(--bg-elevated);
        color: var(--text-secondary);
    }

    .day-pill.active {
        background: var(--accent-primary);
        border-color: var(--accent-primary);
        color: white;
    }

    .day-pill.active:hover {
        background: var(--accent-hover);
        border-color: var(--accent-hover);
    }

    .manage-exercise-actions {
        display: flex;
        gap: 8px;
    }

    .icon-btn {
        width: 32px;
        height: 32px;
        padding: 0;
        background: transparent;
        border: 1px solid var(--border-color);
        border-radius: var(--radius-sm);
        color: var(--text-secondary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
    }

    .icon-btn:hover {
        background: var(--bg-tertiary);
        color: var(--text-primary);
        border-color: var(--border-hover);
    }

    .icon-btn.delete:hover {
        background: rgba(255, 59, 48, 0.1);
        border-color: #ff3b30;
        color: #ff3b30;
    }

    .icon-btn.save:hover {
        background: rgba(0, 208, 132, 0.1);
        border-color: var(--success);
        color: var(--success);
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: 40px 20px;
        color: var(--text-secondary);
    }

    .empty-state-icon {
        font-size: 48px;
        margin-bottom: 16px;
        opacity: 0.5;
    }

    .empty-state-text {
        font-size: 14px;
        margin-bottom: 20px;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .week-grid {
            grid-template-columns: repeat(4, 1fr);
        }
    }

    @media (max-width: 768px) {
        .app-container {
            padding: 12px;
        }

        .header {
            flex-direction: column;
            gap: 12px;
            align-items: stretch;
            padding: 20px 0 24px;
            margin-bottom: 24px;
        }

        .header-nav {
            order: -1;
        }

        .week-header,
        .month-header {
            flex-direction: column;
            gap: 12px;
        }

        .week-navigation,
        .month-navigation {
            width: 100%;
            justify-content: center;
        }

        .week-title,
        .month-title {
            font-size: 16px;
            min-width: 120px;
        }

        .week-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .calendar-grid {
            padding: 12px;
        }

        .calendar-days {
            gap: 4px;
        }

        .calendar-day {
            padding: 8px;
        }

        .modal-content {
            width: 95%;
            max-height: 95vh;
            margin: 0 8px;
        }

        .modal-header,
        .modal-body,
        .modal-footer {
            padding: 16px;
        }

        .set-row {
            grid-template-columns: 50px 1fr 1fr;
            gap: 8px;
        }

        .set-label {
            grid-column: 1 / -1;
            margin-bottom: -4px;
            font-size: 12px;
        }

        .btn {
            font-size: 13px;
            padding: 8px 14px;
        }
    }

    @media (max-width: 480px) {
        .app-container {
            padding: 8px;
        }

        .header {
            padding: 16px 0 20px;
            margin-bottom: 20px;
        }

        .logo {
            font-size: 18px;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
        }

        .week-grid {
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .week-title,
        .month-title {
            font-size: 14px;
            min-width: 100px;
        }

        .day-card {
            min-height: 180px;
        }
    }
</style>
```

</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <div class="logo-icon">L</div>
                <span>Lift</span>
            </div>
            <nav class="header-nav">
                <button class="nav-btn active" data-view="weekly">Week</button>
                <button class="nav-btn" data-view="monthly">Calendar</button>
            </nav>
            <div class="header-actions">
                <button class="btn btn-secondary" id="manageExercisesBtn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M2 4H14M2 8H14M2 12H14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Exercises
                </button>
                <button class="btn btn-secondary" id="addExerciseBtn">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                        <path d="M8 3V13M3 8H13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    New Exercise
                </button>
            </div>
        </header>

```
    <!-- Weekly View -->
    <div id="weeklyView" class="view-container active">
        <div class="week-header">
            <div class="week-navigation">
                <button class="week-nav-btn" id="prevWeek">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M12 15L7 10L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <h2 class="week-title" id="weekTitle"></h2>
                <button class="week-nav-btn" id="nextWeek">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M8 5L13 10L8 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
            <button class="btn btn-ghost" id="todayBtn">Today</button>
        </div>

        <div class="week-grid" id="weekGrid">
            <!-- Days will be generated here -->
        </div>
    </div>

    <!-- Monthly View -->
    <div id="monthlyView" class="view-container">
        <div class="month-header">
            <div class="month-navigation">
                <button class="month-nav-btn" id="prevMonth">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M12 15L7 10L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <h2 class="month-title" id="monthTitle"></h2>
                <button class="month-nav-btn" id="nextMonth">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M8 5L13 10L8 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
            </div>
        </div>

        <div class="calendar-grid">
            <div class="calendar-day-names">
                <div class="calendar-day-name">Sun</div>
                <div class="calendar-day-name">Mon</div>
                <div class="calendar-day-name">Tue</div>
                <div class="calendar-day-name">Wed</div>
                <div class="calendar-day-name">Thu</div>
                <div class="calendar-day-name">Fri</div>
                <div class="calendar-day-name">Sat</div>
            </div>
            <div class="calendar-days" id="calendarDays">
                <!-- Calendar days will be generated here -->
            </div>
        </div>
    </div>
</div>

<!-- Manage Exercises Modal -->
<div class="modal" id="manageExercisesModal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Manage Exercises</h3>
            <button class="modal-close">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M5 5L15 15M5 15L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div id="manageExercisesList">
                <!-- Exercise management items will be generated here -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost modal-cancel">Close</button>
        </div>
    </div>
</div>

<!-- Add Exercise Modal -->
<div class="modal" id="addExerciseModal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Create Exercise</h3>
            <button class="modal-close">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M5 5L15 15M5 15L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label>Exercise Name</label>
                <input type="text" id="exerciseName" placeholder="Bench Press" class="input">
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost modal-cancel">Cancel</button>
            <button class="btn btn-primary" id="saveExerciseBtn">Create</button>
        </div>
    </div>
</div>

<!-- Log Workout Modal -->
<div class="modal" id="logWorkoutModal">
    <div class="modal-overlay"></div>
    <div class="modal-content modal-lg">
        <div class="modal-header">
            <div>
                <h3 id="logWorkoutTitle"></h3>
                <p class="text-secondary" id="logWorkoutSubtitle"></p>
            </div>
            <button class="modal-close">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M5 5L15 15M5 15L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div id="exercisesList">
                <!-- Exercise log entries will be generated here -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost modal-cancel">Cancel</button>
            <button class="btn btn-primary" id="saveWorkoutBtn">Save Workout</button>
        </div>
    </div>
</div>

<!-- Exercise Selection Modal -->
<div class="modal" id="exerciseSelectModal">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Add Exercise to <span id="exerciseSelectDay"></span></h3>
            <button class="modal-close">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M5 5L15 15M5 15L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        <div class="modal-body">
            <div id="exerciseSelectList" class="exercise-select-list">
                <!-- Exercise checkboxes will be generated here -->
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-ghost modal-cancel">Cancel</button>
            <button class="btn btn-primary" id="saveExerciseSelectionBtn">Add to Day</button>
        </div>
    </div>
</div>

<script>
    // Data Storage
    const APP_DATA_KEY = 'liftAppData';

    // State
    let state = {
        exercises: [],
        schedule: {}, // { dayOfWeek: [exerciseIds] } - 0=Sun, 1=Mon, etc.
        workouts: {}, // { 'YYYY-MM-DD': { exerciseId: { sets: [{reps, weight}] } } }
        currentWeekStart: null,
        currentMonth: null,
        currentYear: null
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
        loadData();
        initializeCurrentDates();
        setupEventListeners();
        renderWeekView();
    });

    function initializeCurrentDates() {
        const today = new Date();
        state.currentWeekStart = getWeekStart(today);
        state.currentMonth = today.getMonth();
        state.currentYear = today.getFullYear();
    }

    function getWeekStart(date) {
        const d = new Date(date);
        const day = d.getDay();
        const diff = d.getDate() - day;
        return new Date(d.setDate(diff));
    }

    function formatDate(date) {
        return date.toISOString().split('T')[0];
    }

    function formatDateDisplay(date) {
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    }

    function formatDateAbbreviated(date) {
        const month = date.getMonth() + 1;
        const day = date.getDate();
        const year = date.getFullYear().toString().slice(-2);
        return `${month}/${day}/${year}`;
    }

    // Data Persistence
    function loadData() {
        const saved = localStorage.getItem(APP_DATA_KEY);
        if (saved) {
            const parsed = JSON.parse(saved);
            state.exercises = parsed.exercises || [];
            state.schedule = parsed.schedule || {};
            state.workouts = parsed.workouts || {};
        }
    }

    function saveData() {
        localStorage.setItem(APP_DATA_KEY, JSON.stringify({
            exercises: state.exercises,
            schedule: state.schedule,
            workouts: state.workouts
        }));
    }

    // Event Listeners
    function setupEventListeners() {
        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const view = btn.dataset.view;
                switchView(view);
            });
        });

        // Week navigation
        document.getElementById('prevWeek').addEventListener('click', () => {
            state.currentWeekStart.setDate(state.currentWeekStart.getDate() - 7);
            renderWeekView();
        });

        document.getElementById('nextWeek').addEventListener('click', () => {
            state.currentWeekStart.setDate(state.currentWeekStart.getDate() + 7);
            renderWeekView();
        });

        document.getElementById('todayBtn').addEventListener('click', () => {
            state.currentWeekStart = getWeekStart(new Date());
            renderWeekView();
        });

        // Month navigation
        document.getElementById('prevMonth').addEventListener('click', () => {
            state.currentMonth--;
            if (state.currentMonth < 0) {
                state.currentMonth = 11;
                state.currentYear--;
            }
            renderMonthView();
        });

        document.getElementById('nextMonth').addEventListener('click', () => {
            state.currentMonth++;
            if (state.currentMonth > 11) {
                state.currentMonth = 0;
                state.currentYear++;
            }
            renderMonthView();
        });

        // Add Exercise Modal
        document.getElementById('addExerciseBtn').addEventListener('click', () => {
            openModal('addExerciseModal');
        });

        // Manage Exercises Modal
        document.getElementById('manageExercisesBtn').addEventListener('click', () => {
            openManageExercisesModal();
        });

        document.getElementById('saveExerciseBtn').addEventListener('click', saveExercise);

        document.getElementById('exerciseName').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                saveExercise();
            }
        });

        // Save Workout
        document.getElementById('saveWorkoutBtn').addEventListener('click', saveWorkout);

        // Save Exercise Selection
        document.getElementById('saveExerciseSelectionBtn').addEventListener('click', saveExerciseSelection);

        // Modal close buttons
        document.querySelectorAll('.modal-close, .modal-cancel').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const modal = e.target.closest('.modal');
                closeModal(modal.id);
            });
        });

        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                const modal = e.target.closest('.modal');
                closeModal(modal.id);
            });
        });
    }

    // View Switching
    function switchView(view) {
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.view === view);
        });

        document.querySelectorAll('.view-container').forEach(container => {
            container.classList.remove('active');
        });

        if (view === 'weekly') {
            document.getElementById('weeklyView').classList.add('active');
            renderWeekView();
        } else if (view === 'monthly') {
            document.getElementById('monthlyView').classList.add('active');
            renderMonthView();
        }
    }

    // Week View
    function renderWeekView() {
        const weekGrid = document.getElementById('weekGrid');
        const weekTitle = document.getElementById('weekTitle');
        
        const weekDays = [];
        for (let i = 0; i < 7; i++) {
            const date = new Date(state.currentWeekStart);
            date.setDate(date.getDate() + i);
            weekDays.push(date);
        }

        const startDate = formatDateAbbreviated(weekDays[0]);
        const endDate = formatDateAbbreviated(weekDays[6]);
        weekTitle.textContent = `${startDate} - ${endDate}`;

        weekGrid.innerHTML = weekDays.map((date, index) => {
            const dayKey = date.getDay();
            const dateKey = formatDate(date);
            const exercises = (state.schedule[dayKey] || [])
                .map(id => state.exercises.find(ex => ex.id === id))
                .filter(Boolean);
            
            const isToday = formatDate(new Date()) === dateKey;
            const hasWorkout = state.workouts[dateKey];

            return `
                <div class="day-card ${isToday ? 'today' : ''} ${hasWorkout ? 'has-workout' : ''}" 
                     data-day="${dayKey}" 
                     data-date="${dateKey}"
                     draggable="false">
                    <div class="day-header">
                        <div class="day-name">${date.toLocaleDateString('en-US', { weekday: 'short' })}</div>
                        <div class="day-date">${date.getDate()}</div>
                    </div>
                    <div class="exercises-list" data-day="${dayKey}">
                        ${exercises.map(ex => {
                            const workout = hasWorkout ? hasWorkout[ex.id] : null;
                            const stats = workout ? 
                                `${workout.sets.length}x${workout.sets[0]?.reps || 0} @ ${workout.sets[0]?.weight || 0}lbs` : 
                                '';
                            return `
                                <div class="exercise-item" 
                                     draggable="true" 
                                     data-exercise-id="${ex.id}"
                                     data-day="${dayKey}">
                                    <div class="exercise-item-content">
                                        <span class="exercise-name">${ex.name}</span>
                                        ${stats ? `<span class="exercise-stats">${stats}</span>` : ''}
                                    </div>
                                    <button class="exercise-item-edit" data-exercise-id="${ex.id}" data-date="${dateKey}" title="Edit workout">
                                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                                            <path d="M10 1.75004C10.1651 1.58493 10.3605 1.45355 10.5754 1.36238C10.7903 1.2712 11.0206 1.22217 11.2538 1.22217C11.487 1.22217 11.7173 1.2712 11.9322 1.36238C12.1471 1.45355 12.3425 1.58493 12.5076 1.75004C12.6727 1.91514 12.804 2.11052 12.8952 2.32542C12.9864 2.54031 13.0354 2.77062 13.0354 3.00379C13.0354 3.23696 12.9864 3.46727 12.8952 3.68216C12.804 3.89706 12.6727 4.09244 12.5076 4.25754L4.66634 12.0988L1.33301 12.9988L2.23301 9.66546L10 1.75004Z" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </button>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <button class="add-exercise-btn" data-day="${dayKey}">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
                            <path d="M7 2V12M2 7H12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Add Exercise
                    </button>
                </div>
            `;
        }).join('');

        // Setup drag and drop
        setupDragAndDrop();

        // Setup day card clicks
        document.querySelectorAll('.day-card').forEach(card => {
            card.addEventListener('click', (e) => {
                if (!e.target.closest('.exercise-item') && !e.target.closest('.add-exercise-btn')) {
                    const date = card.dataset.date;
                    openLogWorkoutModal(date);
                }
            });
        });

        // Setup add exercise buttons
        document.querySelectorAll('.add-exercise-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const day = parseInt(btn.dataset.day);
                openExerciseSelectModal(day);
            });
        });

        // Setup exercise edit buttons
        document.querySelectorAll('.exercise-item-edit').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const exerciseId = btn.dataset.exerciseId;
                const date = btn.dataset.date;
                openLogWorkoutModal(date, exerciseId);
            });
        });
    }

    // Month View
    function renderMonthView() {
        const monthTitle = document.getElementById('monthTitle');
        const calendarDays = document.getElementById('calendarDays');
        
        const date = new Date(state.currentYear, state.currentMonth, 1);
        monthTitle.textContent = date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

        const firstDay = date.getDay();
        const daysInMonth = new Date(state.currentYear, state.currentMonth + 1, 0).getDate();
        const daysInPrevMonth = new Date(state.currentYear, state.currentMonth, 0).getDate();

        let html = '';
        
        // Previous month days
        for (let i = firstDay - 1; i >= 0; i--) {
            const day = daysInPrevMonth - i;
            const prevMonth = state.currentMonth - 1;
            const prevYear = prevMonth < 0 ? state.currentYear - 1 : state.currentYear;
            const actualMonth = prevMonth < 0 ? 11 : prevMonth;
            const dateKey = `${prevYear}-${String(actualMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            
            html += `<div class="calendar-day other-month" data-date="${dateKey}">
                <div class="calendar-day-number">${day}</div>
            </div>`;
        }

        // Current month days
        for (let day = 1; day <= daysInMonth; day++) {
            const dateKey = `${state.currentYear}-${String(state.currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const isToday = formatDate(new Date()) === dateKey;
            const workout = state.workouts[dateKey];
            const hasWorkout = workout && Object.keys(workout).length > 0;
            
            let exerciseText = '';
            if (hasWorkout) {
                const exerciseCount = Object.keys(workout).length;
                exerciseText = `${exerciseCount} exercise${exerciseCount > 1 ? 's' : ''}`;
            }

            html += `
                <div class="calendar-day ${isToday ? 'today' : ''} ${hasWorkout ? 'has-workout' : ''}" 
                     data-date="${dateKey}">
                    <div class="calendar-day-number">${day}</div>
                    <div class="calendar-day-exercises">${exerciseText}</div>
                </div>
            `;
        }

        // Next month days
        const totalCells = firstDay + daysInMonth;
        const remainingCells = totalCells % 7 === 0 ? 0 : 7 - (totalCells % 7);
        for (let day = 1; day <= remainingCells; day++) {
            const nextMonth = state.currentMonth + 1;
            const nextYear = nextMonth > 11 ? state.currentYear + 1 : state.currentYear;
            const actualMonth = nextMonth > 11 ? 0 : nextMonth;
            const dateKey = `${nextYear}-${String(actualMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            
            html += `<div class="calendar-day other-month" data-date="${dateKey}">
                <div class="calendar-day-number">${day}</div>
            </div>`;
        }

        calendarDays.innerHTML = html;

        // Setup calendar day clicks
        document.querySelectorAll('.calendar-day:not(.other-month)').forEach(day => {
            day.addEventListener('click', () => {
                const date = day.dataset.date;
                openLogWorkoutModal(date);
            });
        });
    }

    // Drag and Drop
    function setupDragAndDrop() {
        const exerciseItems = document.querySelectorAll('.exercise-item');
        const exerciseLists = document.querySelectorAll('.exercises-list');

        exerciseItems.forEach(item => {
            item.addEventListener('dragstart', handleDragStart);
            item.addEventListener('dragend', handleDragEnd);
        });

        exerciseLists.forEach(list => {
            list.addEventListener('dragover', handleDragOver);
            list.addEventListener('drop', handleDrop);
            list.addEventListener('dragleave', handleDragLeave);
        });
    }

    let draggedElement = null;

    function handleDragStart(e) {
        draggedElement = e.target;
        e.target.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
    }

    function handleDragEnd(e) {
        e.target.classList.remove('dragging');
        document.querySelectorAll('.exercises-list').forEach(list => {
            list.style.background = '';
        });
    }

    function handleDragOver(e) {
        if (e.preventDefault) {
            e.preventDefault();
        }
        e.dataTransfer.dropEffect = 'move';
        e.currentTarget.style.background = 'rgba(252, 82, 0, 0.1)';
        return false;
    }

    function handleDragLeave(e) {
        e.currentTarget.style.background = '';
    }

    function handleDrop(e) {
        if (e.stopPropagation) {
            e.stopPropagation();
        }
        e.currentTarget.style.background = '';

        const targetDay = parseInt(e.currentTarget.dataset.day);
        const sourceDay = parseInt(draggedElement.dataset.day);
        const exerciseId = draggedElement.dataset.exerciseId;

        if (targetDay !== sourceDay) {
            // Remove from source day
            if (state.schedule[sourceDay]) {
                state.schedule[sourceDay] = state.schedule[sourceDay].filter(id => id !== exerciseId);
            }

            // Add to target day
            if (!state.schedule[targetDay]) {
                state.schedule[targetDay] = [];
            }
            if (!state.schedule[targetDay].includes(exerciseId)) {
                state.schedule[targetDay].push(exerciseId);
            }

            saveData();
            renderWeekView();
        }

        return false;
    }

    // Exercise Management
    function saveExercise() {
        const nameInput = document.getElementById('exerciseName');
        const name = nameInput.value.trim();

        if (!name) {
            alert('Please enter an exercise name');
            return;
        }

        const exercise = {
            id: Date.now().toString(),
            name: name
        };

        state.exercises.push(exercise);
        saveData();
        
        nameInput.value = '';
        closeModal('addExerciseModal');
        renderWeekView();
    }

    function openManageExercisesModal() {
        const modal = document.getElementById('manageExercisesModal');
        const list = document.getElementById('manageExercisesList');

        if (state.exercises.length === 0) {
            list.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon"></div>
                    <div class="empty-state-text">No exercises yet. Create one first!</div>
                </div>
            `;
        } else {
            const dayAbbreviations = ['Su', 'M', 'Tu', 'W', 'Th', 'F', 'Sa'];
            const fullDayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            
            list.innerHTML = state.exercises.map(ex => {
                // Find which days this exercise is scheduled on
                const scheduledDays = [];
                Object.keys(state.schedule).forEach(day => {
                    if (state.schedule[day] && state.schedule[day].includes(ex.id)) {
                        scheduledDays.push(parseInt(day));
                    }
                });

                return `
                    <div class="manage-exercise-item" data-exercise-id="${ex.id}">
                        <div class="exercise-info">
                            <input type="text" 
                                   class="exercise-name-input" 
                                   value="${ex.name}" 
                                   disabled
                                   data-exercise-id="${ex.id}">
                            <div class="exercise-days">
                                ${dayAbbreviations.map((abbr, dayIndex) => {
                                    const isScheduled = scheduledDays.includes(dayIndex);
                                    return `
                                        <button class="day-pill ${isScheduled ? 'active' : ''}" 
                                                data-exercise-id="${ex.id}" 
                                                data-day="${dayIndex}"
                                                title="${fullDayNames[dayIndex]}">
                                            ${abbr}
                                        </button>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                        <div class="manage-exercise-actions">
                            <button class="icon-btn edit-btn" data-exercise-id="${ex.id}" title="Edit name">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M11.333 2.00004C11.5081 1.82494 11.716 1.68605 11.9447 1.59129C12.1735 1.49653 12.4187 1.44775 12.6663 1.44775C12.914 1.44775 13.1592 1.49653 13.3879 1.59129C13.6167 1.68605 13.8246 1.82494 13.9997 2.00004C14.1748 2.17513 14.3137 2.383 14.4084 2.61178C14.5032 2.84055 14.552 3.08575 14.552 3.33337C14.552 3.58099 14.5032 3.82619 14.4084 4.05497C14.3137 4.28374 14.1748 4.49161 13.9997 4.66671L5.33301 13.3334L1.99967 14.3334L2.99967 11L11.333 2.00004Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="icon-btn delete-btn delete" data-exercise-id="${ex.id}" title="Delete">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M2 4H14M12.6667 4V13.3333C12.6667 14 12 14.6667 11.3333 14.6667H4.66667C4 14.6667 3.33333 14 3.33333 13.3333V4M5.33333 4V2.66667C5.33333 2 6 1.33333 6.66667 1.33333H9.33333C10 1.33333 10.6667 2 10.6667 2.66667V4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');

            // Setup day pill toggle buttons
            document.querySelectorAll('.day-pill').forEach(pill => {
                pill.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const exerciseId = pill.dataset.exerciseId;
                    const day = parseInt(pill.dataset.day);
                    
                    // Toggle day scheduling
                    if (!state.schedule[day]) {
                        state.schedule[day] = [];
                    }
                    
                    if (state.schedule[day].includes(exerciseId)) {
                        // Remove from this day
                        state.schedule[day] = state.schedule[day].filter(id => id !== exerciseId);
                        pill.classList.remove('active');
                    } else {
                        // Add to this day
                        state.schedule[day].push(exerciseId);
                        pill.classList.add('active');
                    }
                    
                    saveData();
                    renderWeekView();
                });
            });

            // Setup edit buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = btn.dataset.exerciseId;
                    const input = document.querySelector(`.exercise-name-input[data-exercise-id="${id}"]`);
                    const isEditing = !input.disabled;

                    if (isEditing) {
                        // Save
                        const newName = input.value.trim();
                        if (newName) {
                            const exercise = state.exercises.find(ex => ex.id === id);
                            if (exercise) {
                                exercise.name = newName;
                                saveData();
                                renderWeekView();
                            }
                        }
                        input.disabled = true;
                        btn.innerHTML = `
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M11.333 2.00004C11.5081 1.82494 11.716 1.68605 11.9447 1.59129C12.1735 1.49653 12.4187 1.44775 12.6663 1.44775C12.914 1.44775 13.1592 1.49653 13.3879 1.59129C13.6167 1.68605 13.8246 1.82494 13.9997 2.00004C14.1748 2.17513 14.3137 2.383 14.4084 2.61178C14.5032 2.84055 14.552 3.08575 14.552 3.33337C14.552 3.58099 14.5032 3.82619 14.4084 4.05497C14.3137 4.28374 14.1748 4.49161 13.9997 4.66671L5.33301 13.3334L1.99967 14.3334L2.99967 11L11.333 2.00004Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `;
                        btn.classList.remove('save');
                    } else {
                        // Edit
                        input.disabled = false;
                        input.focus();
                        input.select();
                        btn.innerHTML = `
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M13.3337 4L6.00033 11.3333L2.66699 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        `;
                        btn.classList.add('save');
                    }
                });
            });

            // Setup delete buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const id = btn.dataset.exerciseId;
                    const exercise = state.exercises.find(ex => ex.id === id);
                    
                    if (confirm(`Delete "${exercise.name}"? This will remove it from your library and scheduled days, but keep your workout history.`)) {
                        deleteExercise(id);
                    }
                });
            });

            // Allow Enter to save when editing
            document.querySelectorAll('.exercise-name-input').forEach(input => {
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !input.disabled) {
                        const editBtn = document.querySelector(`.edit-btn[data-exercise-id="${input.dataset.exerciseId}"]`);
                        editBtn.click();
                    }
                });
            });
        }

        openModal('manageExercisesModal');
    }

    function deleteExercise(id) {
        // Remove from exercises array
        state.exercises = state.exercises.filter(ex => ex.id !== id);

        // Remove from schedule
        Object.keys(state.schedule).forEach(day => {
            state.schedule[day] = state.schedule[day].filter(exId => exId !== id);
        });

        // Keep workout history intact - don't delete from state.workouts

        saveData();
        openManageExercisesModal(); // Refresh the modal
        renderWeekView();
    }

    function openExerciseSelectModal(day) {
        const modal = document.getElementById('exerciseSelectModal');
        const dayName = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][day];
        document.getElementById('exerciseSelectDay').textContent = dayName;

        const list = document.getElementById('exerciseSelectList');
        const currentExercises = state.schedule[day] || [];

        if (state.exercises.length === 0) {
            list.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon"></div>
                    <div class="empty-state-text">No exercises yet. Create one first!</div>
                </div>
            `;
        } else {
            list.innerHTML = state.exercises.map(ex => `
                <div class="exercise-select-item">
                    <input type="checkbox" 
                           id="ex-${ex.id}" 
                           value="${ex.id}" 
                           ${currentExercises.includes(ex.id) ? 'checked' : ''}>
                    <label for="ex-${ex.id}">${ex.name}</label>
                </div>
            `).join('');
        }

        modal.dataset.day = day;
        openModal('exerciseSelectModal');
    }

    function saveExerciseSelection() {
        const modal = document.getElementById('exerciseSelectModal');
        const day = parseInt(modal.dataset.day);
        const checkboxes = document.querySelectorAll('#exerciseSelectList input[type="checkbox"]');
        
        const selectedExercises = Array.from(checkboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);

        state.schedule[day] = selectedExercises;
        saveData();
        closeModal('exerciseSelectModal');
        renderWeekView();
    }

    // Workout Logging
    function openLogWorkoutModal(date, autoExpandExerciseId = null) {
        const modal = document.getElementById('logWorkoutModal');
        const dateObj = new Date(date + 'T00:00:00');
        const dayOfWeek = dateObj.getDay();
        
        document.getElementById('logWorkoutTitle').textContent = formatDateDisplay(dateObj);
        document.getElementById('logWorkoutSubtitle').textContent = dateObj.toLocaleDateString('en-US', { weekday: 'long' });

        const scheduledExercises = (state.schedule[dayOfWeek] || [])
            .map(id => state.exercises.find(ex => ex.id === id))
            .filter(Boolean);

        const existingWorkout = state.workouts[date] || {};
        const list = document.getElementById('exercisesList');

        if (scheduledExercises.length === 0) {
            list.innerHTML = `
                <div class="empty-state">
                    <div class="empty-state-icon"></div>
                    <div class="empty-state-text">No exercises scheduled for this day</div>
                </div>
            `;
        } else {
            list.innerHTML = scheduledExercises.map(ex => {
                const lastWeekDate = new Date(dateObj);
                lastWeekDate.setDate(lastWeekDate.getDate() - 7);
                const lastWeekKey = formatDate(lastWeekDate);
                const lastWeekWorkout = state.workouts[lastWeekKey];
                const lastWeekData = lastWeekWorkout ? lastWeekWorkout[ex.id] : null;

                const existingSets = existingWorkout[ex.id]?.sets || [{ reps: '', weight: '' }, { reps: '', weight: '' }, { reps: '', weight: '' }];
                while (existingSets.length < 3) {
                    existingSets.push({ reps: '', weight: '' });
                }

                const shouldExpand = autoExpandExerciseId === ex.id;

                return `
                    <div class="exercise-log-entry ${shouldExpand ? 'expanded' : ''}" data-exercise-id="${ex.id}">
                        <div class="exercise-log-header">
                            <div class="exercise-log-name">${ex.name}</div>
                            <div class="exercise-log-toggle">
                                <span>${shouldExpand ? 'Collapse' : 'Expand'}</span>
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                        </div>
                        ${lastWeekData ? `
                            <div class="last-week-data">
                                <div class="last-week-label">Last Week</div>
                                ${lastWeekData.sets.map((set, i) => 
                                    `Set ${i + 1}: ${set.reps} reps @ ${set.weight} lbs`
                                ).join('  ')}
                            </div>
                        ` : ''}
                        <div class="set-inputs">
                            ${existingSets.map((set, i) => `
                                <div class="set-row">
                                    <div class="set-label">Set ${i + 1}</div>
                                    <div class="set-input-group">
                                        <div class="set-input-label">Reps</div>
                                        <input type="number" 
                                               class="set-input" 
                                               data-set="${i}" 
                                               data-field="reps" 
                                               value="${set.reps}" 
                                               placeholder="0">
                                    </div>
                                    <div class="set-input-group">
                                        <div class="set-input-label">Weight (lbs)</div>
                                        <input type="number" 
                                               class="set-input" 
                                               data-set="${i}" 
                                               data-field="weight" 
                                               value="${set.weight}" 
                                               placeholder="0">
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }).join('');

            // Setup toggle functionality
            document.querySelectorAll('.exercise-log-header').forEach(header => {
                header.addEventListener('click', () => {
                    const entry = header.closest('.exercise-log-entry');
                    const toggle = header.querySelector('.exercise-log-toggle span');
                    entry.classList.toggle('expanded');
                    toggle.textContent = entry.classList.contains('expanded') ? 'Collapse' : 'Expand';
                });
            });
        }

        modal.dataset.date = date;
        openModal('logWorkoutModal');
    }

    function saveWorkout() {
        const modal = document.getElementById('logWorkoutModal');
        const date = modal.dataset.date;
        
        const workout = {};
        document.querySelectorAll('.exercise-log-entry').forEach(entry => {
            const exerciseId = entry.dataset.exerciseId;
            const sets = [];
            
            entry.querySelectorAll('.set-row').forEach(row => {
                const repsInput = row.querySelector('[data-field="reps"]');
                const weightInput = row.querySelector('[data-field="weight"]');
                const reps = parseInt(repsInput.value) || 0;
                const weight = parseFloat(weightInput.value) || 0;
                
                if (reps > 0 || weight > 0) {
                    sets.push({ reps, weight });
                }
            });

            if (sets.length > 0) {
                workout[exerciseId] = { sets };
            }
        });

        state.workouts[date] = workout;
        saveData();
        closeModal('logWorkoutModal');
        renderWeekView();
        
        // Refresh month view if it's active
        if (document.getElementById('monthlyView').classList.contains('active')) {
            renderMonthView();
        }
    }

    // Modal Management
    function openModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.add('active');
        
        // Focus first input if exists
        const firstInput = modal.querySelector('input[type="text"], input[type="number"]');
        if (firstInput) {
            setTimeout(() => firstInput.focus(), 100);
        }
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.classList.remove('active');
    }
</script>
```

</body>
</html>
